<table mat-table
       [dataSource]="data()"
       multiTemplateDataRows
       class="mat-elevation-z8">
    @for(column of columns(); track column){
        <ng-container [matColumnDef]="column.DisplayName">
            <th mat-header-cell
                *matHeaderCellDef>{{ column.DisplayName }}</th>
            <td mat-cell
                *matCellDef="let element">
                @switch (column.Type) {
                    @case ('date') {
                        <ng-container *ngTemplateOutlet="dateColumn"></ng-container>
                    }
                    @default {
                        <ng-container *ngTemplateOutlet="defaultColumn"></ng-container>
                    }
                }
                <ng-template #defaultColumn>
            <td>{{ element[column.Name] }}</td>
            </ng-template>
            <ng-template #dateColumn>
                <td>{{ element[column.Name] | date:'MM/dd/yyyy' }}</td>
            </ng-template>
            </td>
        </ng-container>
    }

    @if(expandable()){
        <ng-container [matColumnDef]="expandColumn.DisplayName">
            <th mat-header-cell
                *matHeaderCellDef
                aria-label="row actions">&nbsp;</th>
            <td mat-cell
                *matCellDef="let element">
                <button mat-icon-button
                        aria-label="expand row"
                        (click)="toggle(element); $event.stopPropagation()"
                        class="example-toggle-button"
                        [class.example-toggle-button-expanded]="isExpanded(element)">
                    <mat-icon>keyboard_arrow_down</mat-icon>
                </button>
            </td>
        </ng-container>

        <ng-container matColumnDef="expandedDetail">
            <td mat-cell
                *matCellDef="let element"
                [attr.colspan]="columns.length + 1">
                <div class="example-element-detail-wrapper"
                     [class.example-element-detail-wrapper-expanded]="isExpanded(element)">
                    <div class="example-element-detail">
                        <div class="example-element-description">
                            {{ element.description }}
                        </div>
                    </div>
                </div>
            </td>
        </ng-container>
    }

    <tr mat-header-row
        *matHeaderRowDef="displayedColumnsDisplayName()"></tr>
    <tr mat-row
        *matRowDef="let element; columns: displayedColumnsDisplayName()"
        class="example-element-row"
        [class.example-expanded-row]="isExpanded(element)"
        (click)="toggle(element)">
    </tr>
</table>